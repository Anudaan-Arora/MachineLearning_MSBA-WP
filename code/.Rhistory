rm(list=ls())
#############################################
# Baseball Examples                         #
#############################################
Data = read.table("RunsPerGame.txt",header=T)
setwd("~/Dropbox/SalemCenter/classes/IntroML-MSBAWP/code_offline")
rm(list=ls())
#############################################
# Baseball Examples                         #
#############################################
Data = read.table("RunsPerGame.txt",header=T)
attach(Data)
#######################################################
#  California Housing Example (Model Selection)
#######################################################
rm(list=ls())
library(glmnet)
ca <- read.csv("CAhousing.csv")
logMedVal <- log(ca$medianHouseValue)
dim(ca)
head(ca)
plot(ca[,1:2])
ca <- ca[,-c(4,5,9)] # lose lmedval and the room totals
n = dim(ca)[1]
tr = sample(1:n,5000)
XXca <- model.matrix(~.*longitude*latitude, data=data.frame(scale(ca)))[,-1]
CAdata = data.frame(logMedVal,XXca)
null = lm(logMedVal~1, data=CAdata[tr,])
full = glm(logMedVal~., data=CAdata[tr,])
regForward = step(null, scope=formula(full), direction="forward", k=log(length(tr)))
regBack = step(full, direction="backward", k=log(length(tr)))
regForward = step(null, scope=formula(full), direction="both", k=log(length(tr)))
XXca = scale(XXca)
Lasso.Fit = glmnet(XXca[tr,],logMedVal[tr])
Ridge.Fit = glmnet(XXca[tr,],logMedVal[tr],alpha=0)
par(mfrow=c(1,2))
plot(Lasso.Fit)
plot(Ridge.Fit)
CV.L = cv.glmnet(XXca[tr,], logMedVal[tr],alpha=1)
CV.R = cv.glmnet(XXca[tr,], logMedVal[tr],alpha=0)
LamR = CV.R$lambda.1se
LamL = CV.L$lambda.1se
par(mfrow=c(1,2))
plot(log(CV.R$lambda),sqrt(CV.R$cvm),main="Ridge CV (k=10)",xlab="log(lambda)",ylab = "RMSE",col=4,type="b",cex.lab=1.2)
abline(v=log(LamR),lty=2,col=2,lwd=2)
plot(log(CV.L$lambda),sqrt(CV.L$cvm),main="LASSO CV (k=10)",xlab="log(lambda)",ylab = "RMSE",col=4,type="b",cex.lab=1.2)
abline(v=log(LamL),lty=2,col=2,lwd=2)
coef.R = predict(CV.R,type="coefficients",s=LamR)
coef.L = predict(CV.L,type="coefficients",s=LamL)
par(mfrow=c(1,1))
plot(abs(coef.R[2:20]),abs(coef.L[2:20]),ylim=c(0,1),xlim=c(0,1))
abline(0,1)
coef.R
coef.L
head(ca)
dim(ca)
barplot(coef.L)
dev.off()
# Apple/Safeway example
dat = read.csv("Apple_Safeway.csv")
head(dat)
lm1 = lm(Apple~Safeway,data=dat)
summary(lm1)
lm2 = lm(Apple~Safeway+SP500,data=dat)
summary(lm2)
dat = read.csv("Apple_Safeway.csv")
head(dat)
lm1 = lm(Apple~Safeway,data=dat)
summary(lm1)
plot(dat$Safeway,dat$Apple,pch=19)
abline(lm1,col='red',lwd=2)
lm2 = lm(Apple~Safeway+SP500,data=dat)
summary(lm2)
lm2 = lm(Apple~Safeway*SP500,data=dat)
summary(lm2)
library(lubridate)
library(tidyverse)
# example 1: of simple linear regression
data = read.csv('../data/housedata.csv')
setwd("~/Dropbox/SalemCenter/classes/IntroML-MSBAWP/MachineLearning_MSBA-WP/code")
library(lubridate)
library(tidyverse)
# example 1: of simple linear regression
data = read.csv('../data/housedata.csv')
fit = lm(Price~Size,data)
summary(fit)
# example 2: ERCOT
# Power grid load every hour for 6 1/2 years
# throughout the 8 ERCOT regions of Texas
# units of grid load are megawatts.
# This represents peak instantaneous demand for power in that hour.
# source: scraped from the ERCOT website
load_ercot = read.csv("../data/load_ercot.csv")
# Now weather data at the KHOU weather station
# temps in F
load_temperature = read.csv("../data/load_temperature.csv")
load_combined = merge(load_ercot, load_temperature, by = 'Time')
head(load_combined)
plot(load_combined$KHOU,load_combined$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8)
load_combined = mutate(load_combined,
Time = ymd_hms(Time))
plot(load_combined$Time,load_combined$COAST,type='l',col=rgb(0,0,0,alpha=0.6))
plot(load_combined$KHOU,load_combined$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8)
# Simple linear regression
lm1 = lm(COAST ~ KHOU, data=load_combined)
summary(lm1)
plot(load_combined$KHOU,load_combined$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8,xlab="temperature (F)",ylab="power demand")
abline(lm1,lty=1,lwd=4,col='blue')
# What about an additional variable?
KHOU_squared = load_combined$KHOU^2
load_combined$KHOU_squared = KHOU_squared
lm2 = lm(COAST ~ KHOU + KHOU_squared, data=load_combined)
summary(lm2)
plot(load_combined$KHOU,load_combined$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8,xlab="temperature (F)",ylab="power demand")
x = load_combined$KHOU
xmin = floor(min(x))
xmax = floor(max(x))
xnew = seq(xmin,xmax,length.out=500)
quadfit = lm2$coefficients[1] + lm2$coefficients[2]*xnew + lm2$coefficients[3]*xnew^2
lines(xnew,quadfit,col=2,lwd=3)
plot(lm1)
plot(lm2)
